import{Q as U}from"./QSpace.8261e0c9.js";import{r as w,F as h,K as m,L as b,M as a,a7 as $,a8 as A,a9 as u,N as T,R as l,O as i,aa as v,T as g,Q as p,ay as E,ae as k,av as y}from"./index.d8b3df7e.js";import{Q as I,a as z}from"./QTable.8e6ac948.js";import{Q as _}from"./QInput.bbaa874a.js";import{Q as F}from"./QForm.b3966b2a.js";import{Q as M}from"./QCard.fe9dec6c.js";import{Q as R}from"./QPage.d05c5b3a.js";import"./QSeparator.87df3f89.js";import"./use-dark.8a152d4a.js";import"./QList.524ab138.js";import"./rtl.4b414a6d.js";import"./use-prevent-scroll.26c04249.js";import"./use-key-composition.d78daa21.js";import"./format.2a3572e1.js";import"./uid.42677368.js";import"./use-form.71407145.js";import"./QChip.4f91d3c0.js";import"./QItem.1fc91bc2.js";import"./selection.8ee3ca47.js";import"./use-model-toggle.755b5428.js";import"./QDialog.5e69c51f.js";import"./use-timeout.309a8458.js";import"./QCheckbox.bc620241.js";import"./option-sizes.c4df7dec.js";import"./use-fullscreen.5a711c5b.js";const K={class:"container"},L={class:"row q-mt-xl"},O={class:"col-2"},P=l("div",{class:"text-h6"},"\u5F8C\u53F0\u7BA1\u7406",-1),j=l("div",{class:"text-subtitle1 q-my-lg"},"\u4F7F\u7528\u8005\u7BA1\u7406",-1),D=l("div",{class:"text-subtitle1 q-my-lg"},"\u5546\u54C1\u7BA1\u7406",-1),G=l("div",{class:"text-subtitle1 q-my-lg"},"\u5E97\u92EA\u7BA1\u7406",-1),H=l("div",{class:"text-subtitle1 q-my-lg"},"\u8A02\u55AE\u7BA1\u7406",-1),J=l("div",{class:"text-subtitle1 q-my-lg"},"\u6D3B\u52D5\u7BA1\u7406",-1),W=l("div",{class:"text-subtitle1 q-my-lg"},"\u767B\u51FA",-1),X={class:"col-10"},Y={class:"flex items-center text-center q-mb-lg"},Z={key:0,class:"text-h4 text-weight-medium"},ee={key:1,class:"text-h4 text-weight-medium"},te=l("div",{class:"text-body1 q-mb-md"},"\u7BA1\u7406\u5E97\u92EA\u9801\u9762",-1),se={key:0},le={class:"column"},oe=k("\u4FEE\u6539"),ie=k("\u522A\u9664"),ae={style:{"max-width":"400px"}},re=l("div",{class:"text-subtitle1 text-weight-medium"},"\u5E97\u92EA\u540D\u7A31:",-1),de=l("div",{class:"text-subtitle1 text-weight-medium"},"\u5E97\u92EA\u96FB\u8A71:",-1),ne=l("div",{class:"text-subtitle1 text-weight-medium"},"\u5E97\u92EA\u4F4D\u5740:",-1),me=l("div",{class:"text-subtitle1 text-weight-medium"},"\u71DF\u696D\u6642\u9593:",-1),ue=l("div",{class:"text-subtitle1 text-weight-medium"},"\u8CA9\u552E\u7CFB\u5217:",-1),ce={class:"q-my-xxl"},Me={__name:"StoreAdmin",setup(pe){const d=w(!1),V=$(),x=w(""),r=h([]),Q=[{name:"name",align:"left",label:"\u5E97\u92EA\u540D\u7A31",field:"name"},{name:"_id",align:"left",label:"\u5E97\u92EA\u7DE8\u865F",field:"_id"},{name:"address",align:"left",label:"\u5E97\u92EA\u4F4D\u5740",field:"address"},{name:"sells",align:"left",label:"\u8CA9\u552E\u7CFB\u5217",field:"sells"},{name:"edit",label:"",align:"left",field:"edit"}],t=h({name:"",phone:"",address:"",time:"",sells:""}),q=()=>{t.name="",t.phone="",t.address="",t.time="",t.sells="",d.value=!1,x.value=""},C=async s=>{try{await y.delete("/stores/"+s),await u.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),f()}catch(e){u.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}},B=(s,e)=>{x.value=s,d.value=!0,t.name=r[e].name,t.phone=r[e].phone,t.address=r[e].address,t.time=r[e].time,t.sells=r[e].sells},c=h({required(s){return!!s||"\u5FC5\u586B"},price(s){return s>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},size(s){var e,n,o;return!s||!s.length||((n=(e=s[0])==null?void 0:e.type)==null?void 0:n.includes("image"))&&((o=s[0])==null?void 0:o.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),N=async()=>{d.value=!0;try{x.value.length===0?(await y.post("/stores",t),await u.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})):(await y.patch("/stores/"+x.value,t),await u.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})),q(),f(),V.push("/admin/store")}catch(s){u.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError&&s.response.data?s.response.data.message:"\u767C\u751F\u932F\u8AA4"})}},f=async()=>{try{const{data:s}=await A.get("/stores");r.splice(0,r.length),r.push(...s.result)}catch{u.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}};return f(),(s,e)=>{const n=T("router-link");return m(),b(R,null,{default:a(()=>[l("section",K,[l("div",L,[l("div",O,[P,i(n,{to:"/admin/user"},{default:a(()=>[j]),_:1}),i(n,{to:"/admin/product"},{default:a(()=>[D]),_:1}),i(n,{to:"/admin/store"},{default:a(()=>[G]),_:1}),i(n,{to:"/admin/order"},{default:a(()=>[H]),_:1}),J,W]),l("div",X,[l("div",Y,[d.value?g("",!0):(m(),v("div",Z,"\u5E97\u92EA\u7BA1\u7406")),d.value?(m(),v("div",ee,"\u65B0\u589E\u5E97\u92EA")):g("",!0),i(U),d.value?g("",!0):(m(),b(p,{key:2,class:"q-px-xl",outline:"",color:"black",label:"\u65B0\u589E\u5E97\u92EA",onClick:e[0]||(e[0]=o=>d.value=!0)}))]),te,d.value?(m(),b(M,{key:1,flat:"",bordered:""},{default:a(()=>[i(F,{onSubmit:e[6]||(e[6]=E(o=>N(),["prevent"])),class:"q-pa-md"},{default:a(()=>[l("div",ae,[re,i(_,{modelValue:t.name,"onUpdate:modelValue":e[1]||(e[1]=o=>t.name=o),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),de,i(_,{modelValue:t.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>t.phone=o),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),ne,i(_,{modelValue:t.address,"onUpdate:modelValue":e[3]||(e[3]=o=>t.address=o),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),me,i(_,{modelValue:t.time,"onUpdate:modelValue":e[4]||(e[4]=o=>t.time=o),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),ue,i(_,{modelValue:t.sells,"onUpdate:modelValue":e[5]||(e[5]=o=>t.sells=o),rules:[c.required],color:"black"},null,8,["modelValue","rules"])]),l("div",ce,[i(p,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88",onClick:q,disabled:t.submitting},null,8,["disabled"]),i(p,{unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",type:"submit",color:"black text-white",label:"\u78BA\u8A8D"})])]),_:1})]),_:1})):(m(),v("div",se,[i(z,{grid:s.$q.screen.xs,flat:"",bordered:"",rows:r,columns:Q,"row-key":"name"},{"body-cell-edit":a(o=>[i(I,{edit:o},{default:a(()=>[l("div",le,[i(p,{class:"q-mb-sm q-px-lg",outline:"",onClick:S=>B(o.row._id,o.rowIndex)},{default:a(()=>[oe]),_:2},1032,["onClick"]),i(p,{outline:"",onClick:S=>C(o.row._id)},{default:a(()=>[ie]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),_:1},8,["grid","rows"])]))])])])]),_:1})}}};export{Me as default};
