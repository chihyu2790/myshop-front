import{Q as L}from"./QSpace.66f19284.js";import{r as q,q as g,a as A,x as u,y as b,z as d,au as U,X as x,A as B,D as i,B as t,Y as v,F as w,Q as V,E as F,G as z,C as D,_ as n,Z as E,a0 as _,$ as M,ax as Q}from"./index.a2b03e35.js";import{Q as f}from"./QInput.4e2565b1.js";import{a as N,Q as C}from"./QTable.1d20975d.js";import{Q as I}from"./QChip.cd3bf68f.js";import{Q as a}from"./QCheckbox.90a3c216.js";import{Q as T}from"./QFile.e10ecac5.js";import{Q as P}from"./QForm.f5046034.js";import{Q as G}from"./QCard.f8756602.js";import{Q as Y}from"./QPage.6e7da592.js";import{u as Z}from"./use-quasar.39cb5b84.js";import"./use-key-composition.12b6fd52.js";import"./use-dark.dbe5cfd8.js";import"./uid.42677368.js";import"./use-form.3b0c811f.js";import"./QSeparator.b1bf199b.js";import"./QList.3b3d8e16.js";import"./rtl.4b414a6d.js";import"./scroll.2858db06.js";import"./QItem.a39cb856.js";import"./use-fullscreen.bd96892b.js";import"./use-model-toggle.09f48a42.js";import"./QDialog.47244a69.js";import"./use-timeout.89e79e2b.js";import"./option-sizes.8cfdc71b.js";const j={class:"container"},H={class:"row q-mt-xl"},J={class:"col-2"},K=i("div",{class:"text-h6"},"\u5F8C\u53F0\u7BA1\u7406",-1),O=i("div",{class:"text-subtitle1 q-my-lg"},"\u4F7F\u7528\u8005\u7BA1\u7406",-1),R=i("div",{class:"text-subtitle1 q-my-lg"},"\u5546\u54C1\u7BA1\u7406",-1),W=i("div",{class:"text-subtitle1 q-my-lg"},"\u5E97\u92EA\u7BA1\u7406",-1),ee=i("div",{class:"text-subtitle1 q-my-lg"},"\u8A02\u55AE\u7BA1\u7406",-1),le=i("div",{class:"text-subtitle1 q-my-lg"},"\u6D3B\u52D5\u7BA1\u7406",-1),oe=i("div",{class:"text-subtitle1 q-my-lg"},"\u767B\u51FA",-1),te={class:"col-10"},se={class:"flex items-center text-center q-mb-lg"},ae={key:0,class:"text-h4 text-weight-medium"},ie={key:1,class:"text-h4 text-weight-medium"},de={key:2,class:"text-h4 text-weight-medium"},re=i("div",{class:"text-body1 q-mb-md"},"\u7BA1\u7406\u5546\u54C1\u9801\u9762",-1),me=["src"],ue={class:"column"},ne=_("\u4FEE\u6539"),ce=_("\u4E0B\u67B6"),pe={style:{"max-width":"400px"}},ge={class:"text-subtitle1 text-weight-medium"},be={class:"text-subtitle1 text-weight-medium"},Ve={class:"text-subtitle1 text-weight-medium q-mb-sm"},fe={class:"text-subtitle1 text-weight-medium q-mb-lg"},xe={class:"text-subtitle1 text-weight-medium q-mb-lg"},ve={class:"text-subtitle1 text-weight-medium q-mb-lg"},we={class:"text-subtitle1 text-weight-medium q-mb-md"},ye={class:"text-subtitle1 text-weight-medium q-my-md"},ke={class:"q-my-xxl"},Ke={__name:"ProductAdmin",setup(qe){q(!1);const y=q(""),S=Z(),c=q("");g(["\u8863\u670D","\u5305\u5305"]),g([]);const e=g({_id:"",name:"",price:0,category:"",sell:!1,image:[],color:[],size:[],classify:[],description:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),p=g({required(s){return!!s||"\u5FC5\u586B"},price(s){return s>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},size(s){var l,r,o;return!s||!s.length||((r=(l=s[0])==null?void 0:l.type)==null?void 0:r.includes("image"))&&((o=s[0])==null?void 0:o.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}});e.classify=A(()=>c.value.split(/\s+/));const h=(s,l)=>{e._id=s,l>-1?(e.name=m[l].name,e.price=m[l].price,e.category=m[l].category,e.sell=m[l].sell,e.description=m[l].description,e.size=m[l].size,e.color=m[l].color,c.value=m[l].classify.toString().replace(/,/g," ")):(e.name="",e.price=0,e.category="",e.sell=!1,e.description="",e.image=[],e.color=[],e.size=[],c.value=""),e.idx=l,e.dialog=!0,e.valid=!1,e.submitting=!1,e.classify.splice(0,e.classify.length)},X=async()=>{e.submitting=!0;const s=new FormData;for(const l in e)if(!["_id","idx","dialog","valid","submitting"].includes(l))if(l==="image")for(const r of e.image)s.append(l,r);else if(l==="color")for(const r of e.color)s.append(l,r);else if(l==="size")for(const r of e.size)s.append(l,r);else if(l==="classify")for(const r of e.classify)s.append(l,r);else s.append(l,e[l]);try{if(e._id.length===0){const{data:l}=await U.post("/products",s);m.push(l.result),x.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await U.patch("/products/"+e._id,s);m[e.idx]=l.result,x.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(l){x.fire({icon:"success",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}e.submitting=!1},$=[{name:"image",align:"left",label:"",field:"image"},{name:"_id",align:"left",label:"id",field:"_id"},{name:"name",required:!0,label:"\u5546\u54C1\u540D\u7A31",align:"left",field:s=>s.name,format:s=>`${s}`},{name:"edit",label:"\u5546\u54C1\u64CD\u4F5C",align:"left"}],m=g([]);return(async()=>{try{const{data:s}=await U.get("/products/all");m.push(...s.result)}catch(s){x.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,l)=>{const r=B("router-link");return u(),b(Y,null,{default:d(()=>[i("section",j,[i("div",H,[i("div",J,[K,t(r,{to:"/admin/user"},{default:d(()=>[O]),_:1}),t(r,{to:"/admin/product"},{default:d(()=>[R]),_:1}),t(r,{to:"/admin/store"},{default:d(()=>[W]),_:1}),t(r,{to:"/admin/order"},{default:d(()=>[ee]),_:1}),le,oe]),i("div",te,[i("div",se,[e.dialog?w("",!0):(u(),v("div",ae,"\u5546\u54C1\u7BA1\u7406")),e.dialog&&e._id==""?(u(),v("div",ie,"\u65B0\u589E\u5546\u54C1")):w("",!0),e.dialog&&e._id!=""?(u(),v("div",de,"\u7DE8\u8F2F\u5546\u54C1")):w("",!0),t(L),e.dialog?w("",!0):(u(),b(V,{key:3,class:"q-px-xl",outline:"",color:"black",label:"\u65B0\u589E\u5546\u54C1",onClick:l[0]||(l[0]=o=>h("",-1))}))]),re,e.dialog?(u(),b(G,{key:1,flat:"",bordered:"",modelValue:e.dialog,"onUpdate:modelValue":l[36]||(l[36]=o=>e.dialog=o)},{default:d(()=>[t(P,{onSubmit:Q(X,["prevent"]),class:"q-pa-md"},{default:d(()=>[i("div",pe,[i("div",ge,"\u540D\u7A31:"+n(e.name),1),t(f,{modelValue:e.name,"onUpdate:modelValue":l[2]||(l[2]=o=>e.name=o),rules:[p.required],color:"black"},null,8,["modelValue","rules"]),i("div",be,"\u50F9\u683C:"+n(e.price),1),t(f,{modelValue:e.price,"onUpdate:modelValue":l[3]||(l[3]=o=>e.price=o),modelModifiers:{number:!0},min:"0",type:"number",rules:[p.required,p.price],color:"black"},null,8,["modelValue","rules"]),i("div",Ve,"\u985E\u5225:"+n(e.classify),1),t(f,{color:"black",modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=o=>c.value=o),rules:[p.required]},null,8,["modelValue","rules"]),(u(!0),v(M,null,E(e.classify,(o,k)=>(u(),b(I,{key:k},{default:d(()=>[_(n(o),1)]),_:2},1024))),128)),i("div",fe,"\u4E0A\u67B6:"+n(e.sell),1),t(a,{modelValue:e.sell,"onUpdate:modelValue":l[5]||(l[5]=o=>e.sell=o),color:"black",class:"q-mb-md"},null,8,["modelValue"]),i("div",xe,"\u5546\u54C1\u5716\u7247"+n(e.image),1),t(T,{modelValue:e.image,"onUpdate:modelValue":l[8]||(l[8]=o=>e.image=o),multiple:"",rules:[p.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:d(()=>[t(z,{name:"cloud_upload",onClick:l[6]||(l[6]=Q(()=>{},["stop","prevent"]))})]),append:d(()=>[t(z,{name:"close",onClick:l[7]||(l[7]=Q(o=>s.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:d(()=>[]),_:1},8,["modelValue","rules"]),i("div",ve,"\u5546\u54C1\u63CF\u8FF0"+n(e.description),1),t(f,{class:"q-mb-lg",modelValue:e.description,"onUpdate:modelValue":l[9]||(l[9]=o=>e.description=o),type:"textarea",filled:"",color:"black"},null,8,["modelValue"])]),i("div",we,"\u5546\u54C1\u984F\u8272"+n(e.color),1),t(a,{modelValue:e.color,"onUpdate:modelValue":l[10]||(l[10]=o=>e.color=o),class:"text-weight-medium",val:"black",color:"black",label:"black"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[11]||(l[11]=o=>e.color=o),class:"text-weight-medium",val:"white",color:"white",label:"white"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[12]||(l[12]=o=>e.color=o),class:"text-weight-medium",val:"grey",color:"grey",label:"grey"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[13]||(l[13]=o=>e.color=o),class:"text-weight-medium",val:"grey-1",color:"grey-1",label:"grey-1"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[14]||(l[14]=o=>e.color=o),class:"text-weight-medium",val:"grey-8",color:"grey-8",label:"grey-8"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[15]||(l[15]=o=>e.color=o),class:"text-weight-medium",val:"yellow-10",color:"yellow-10",label:"yellow-10"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[16]||(l[16]=o=>e.color=o),class:"text-weight-medium",val:"orange-11",color:"orange-11",label:"orange-11"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[17]||(l[17]=o=>e.color=o),class:"text-weight-medium",val:"brown-1",color:"brown-1",label:"brown-1"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[18]||(l[18]=o=>e.color=o),class:"text-weight-medium",val:"brown-12",color:"brown-12",label:"brown-12"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[19]||(l[19]=o=>e.color=o),class:"text-weight-medium",val:"brown",color:"brown",label:"brown"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[20]||(l[20]=o=>e.color=o),class:"text-weight-medium",val:"blue-grey-3",color:"blue-grey-3",label:"blue-grey-3"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[21]||(l[21]=o=>e.color=o),class:"text-weight-medium",val:"blue-grey-7",color:"blue-grey-7",label:"blue-grey-7"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[22]||(l[22]=o=>e.color=o),class:"text-weight-medium",val:"blue-11",color:"blue-11",label:"blue-11"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[23]||(l[23]=o=>e.color=o),class:"text-weight-medium",val:"indigo-10",color:"indigo-10",label:"indigo-10"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[24]||(l[24]=o=>e.color=o),class:"text-weight-medium",val:"deep-purple-2",color:"deep-purple-2",label:"deep-purple-2"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[25]||(l[25]=o=>e.color=o),class:"text-weight-medium",val:"pink-7",color:"pink-7",label:"pink-7"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[26]||(l[26]=o=>e.color=o),class:"text-weight-medium",val:"pink-10",color:"pink-10",label:"pink-10"},null,8,["modelValue"]),t(a,{modelValue:e.color,"onUpdate:modelValue":l[27]||(l[27]=o=>e.color=o),class:"text-weight-medium",val:"red-10",color:"red-10",label:"red-10"},null,8,["modelValue"]),i("div",ye,"\u5546\u54C1\u5C3A\u5BF8"+n(e.size),1),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[28]||(l[28]=o=>e.size=o),class:"text-weight-medium",val:"XXS",label:"XXS"},null,8,["modelValue"]),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[29]||(l[29]=o=>e.size=o),class:"text-weight-medium",val:"XS",label:"XS"},null,8,["modelValue"]),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[30]||(l[30]=o=>e.size=o),class:"text-weight-medium",val:"S",label:"S"},null,8,["modelValue"]),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[31]||(l[31]=o=>e.size=o),class:"text-weight-medium",val:"M",label:"M"},null,8,["modelValue"]),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[32]||(l[32]=o=>e.size=o),class:"text-weight-medium",val:"L",label:"L"},null,8,["modelValue"]),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[33]||(l[33]=o=>e.size=o),class:"text-weight-medium",val:"XL",label:"XL"},null,8,["modelValue"]),t(a,{color:"black",modelValue:e.size,"onUpdate:modelValue":l[34]||(l[34]=o=>e.size=o),class:"text-weight-medium",val:"XXL",label:"XXL"},null,8,["modelValue"]),i("div",ke,[t(V,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88",onClick:l[35]||(l[35]=o=>e.dialog=!1),disabled:e.submitting},null,8,["disabled"]),t(V,{unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",type:"submit",color:"black text-white",label:"\u78BA\u5B9A"})])]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])):(u(),b(N,{key:0,grid:F(S).screen.xs,flat:"",bordered:"",rows:m,columns:$,"row-key":"name",filter:y.value},{"top-right":d(()=>[t(f,{borderless:"",dense:"",debounce:"300",modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=o=>y.value=o),placeholder:"Search"},{append:d(()=>[t(z,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":d(o=>[t(C,null,{default:d(()=>[t(D,{square:"",size:"100px"},{default:d(()=>[i("img",{src:o.row.image[0],alt:"",class:"q-mb-xl"},null,8,me)]),_:2},1024)]),_:2},1024)]),"body-cell-edit":d(o=>[t(C,{edit:o},{default:d(()=>[i("div",ue,[t(V,{class:"q-mb-sm",onClick:k=>h(o.row._id,o.rowIndex),outline:""},{default:d(()=>[ne]),_:2},1032,["onClick"]),t(V,{onClick:k=>s.updateCart(o.row._id),outline:""},{default:d(()=>[ce]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),_:1},8,["grid","rows","filter"]))])])])]),_:1})}}};export{Ke as default};
