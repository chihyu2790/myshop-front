import{Q as A}from"./QSpace.8261e0c9.js";import{e as se,X as le,r as y,F as V,I as oe,a as ae,K as a,L as v,M as d,av as k,a9 as _,N as ie,R as s,O as o,aa as r,T as Q,Q as C,U as S,ay as z,ab as h,ac as I,ad as f,S as E,P as re,y as T}from"./index.d8b3df7e.js";import{Q as w}from"./QSeparator.87df3f89.js";import{Q as L}from"./QInput.bbaa874a.js";import{Q as ne}from"./QFile.7d6d2135.js";import{Q as N}from"./QImg.0d3437a0.js";import{Q as H}from"./QForm.b3966b2a.js";import{Q as $}from"./QCard.fe9dec6c.js";import{Q as O}from"./QRadio.7322c0ba.js";import{g as de,h as ce,Q as ue}from"./QDialog.5e69c51f.js";import{Q as me}from"./QPage.d05c5b3a.js";import"./use-dark.8a152d4a.js";import"./use-key-composition.d78daa21.js";import"./format.2a3572e1.js";import"./uid.42677368.js";import"./use-form.71407145.js";import"./QChip.4f91d3c0.js";import"./option-sizes.c4df7dec.js";import"./use-prevent-scroll.26c04249.js";import"./use-timeout.309a8458.js";import"./use-model-toggle.755b5428.js";function X(i){if(i===!1)return 0;if(i===!0||i===void 0)return 1;const n=parseInt(i,10);return isNaN(n)?0:n}var j=se({name:"close-popup",beforeMount(i,{value:n}){const c={depth:X(n),handler(m){c.depth!==0&&setTimeout(()=>{const p=de(i);p!==void 0&&ce(p,m,c.depth)})},handlerKey(m){le(m,13)===!0&&c.handler(m)}};i.__qclosepopup=c,i.addEventListener("click",c.handler),i.addEventListener("keyup",c.handlerKey)},updated(i,{value:n,oldValue:c}){n!==c&&(i.__qclosepopup.depth=X(n))},beforeUnmount(i){const n=i.__qclosepopup;i.removeEventListener("click",n.handler),i.removeEventListener("keyup",n.handlerKey),delete i.__qclosepopup}});const pe={class:"container"},xe={class:"row q-mt-xl"},ve={class:"col-2"},_e=s("div",{class:"text-h6"},"\u5E97\u54E1\u7BA1\u7406",-1),he=s("div",{class:"text-subtitle1 q-my-lg"},"\u5E97\u54E1\u8CC7\u6599",-1),fe=s("div",{class:"text-subtitle1 q-my-lg"},"\u7A7F\u642D\u7BA1\u7406",-1),ge={class:"col-10"},ye={class:"flex items-center text-center q-mb-lg"},be={key:0,class:"text-h4 text-weight-medium"},qe={key:1,class:"text-h4 text-weight-medium"},ke=s("div",{class:"text-body1 q-mb-md"},"\u5E97\u54E1\u7A7F\u642D\u7BA1\u7406\u9801\u9762",-1),we=s("div",{class:"text-h5"},"\u7A7F\u642D\u8A73\u7D30",-1),Ve=s("div",{class:"text-h6 text-weight-medium"},"\u7A7F\u642D\u8CC7\u6599",-1),Qe={style:{"max-width":"400px"}},Ce=s("div",{class:"text-subtitle1 text-weight-medium"},"\u7A7F\u642D\u540D\u7A31",-1),Se=s("div",{class:"text-subtitle1 text-weight-medium q-mb-lg"},"\u7A7F\u642D\u4E3B\u5716",-1),Ee=s("div",{class:"text-subtitle1 text-weight-medium q-mb-lg"},"\u7A7F\u642D\u63CF\u8FF0",-1),Ue={class:"row items-center q-pr-md"},Ae=s("div",{class:"text-h6"},"\u5546\u54C1\u8CC7\u6599",-1),ze={class:"col-10 column"},Ie=s("div",{class:"text-subtitle1 text-weight-medium"},"\u5546\u54C1\u540D\u7A31:",-1),$e={class:"text-subtitle1 text-weight-medium"},De={class:"text-subtitle1 text-weight-medium"},Fe={class:"text-subtitle1 text-weight-medium"},Le={class:"q-mt-xl"},Ne={class:"row"},Be={class:"row absolute-top text-subtitle1 transparent-background"},Ke=s("div",{class:"text-h5"},"\u5546\u54C1\u8CC7\u8A0A",-1),Pe={style:{width:"250px"}},Me=s("div",{class:"text-subtitle1 text-weight-medium"},"\u5546\u54C1\u540D\u7A31",-1),Re={class:"row q-mt-xl"},Te={class:"col-12"},He=s("div",{class:"text-subtitle1 text-weight-medium q-my-lg"},"\u5546\u54C1\u984F\u8272",-1),Oe={key:0,class:"q-my-lg"},Xe=s("div",{class:"text-subtitle1 text-weight-medium q-my-lg"},"\u5546\u54C1\u5C3A\u5BF8",-1),je={key:1},Ge={class:"q-mt-xl"},ht={__name:"StylingStaff",setup(i){y(0);const n=y(""),c=y(""),m=y(""),p=V([]),U=V([]),G=oe(),D=y(!1),B=V([]),x=V({name:"",description:"",image:null}),g=y(!0);y("");const K=V({required(l){return!!l||"\u5FC5\u586B"}}),J=()=>{c.value="",n.value="",m.value=""},W=async()=>{await G.addCart({product:b.value[0]._id,quantity:1,color:n.value,size:c.value}),P()},Y=async()=>{g.value=!0;try{await k.patch("/staffs/delete"),p.splice(0,p.length)}catch(l){_.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}},Z=async()=>{const l=new FormData;for(const e in x)l.append(e,x[e]);try{const{data:e}=await k.post("/stylings",l);_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u7A7F\u642D\u6210\u529F"}),g.value=!0}catch(e){_.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}},b=ae(()=>B.filter(l=>l.name.includes(m.value))),ee=async l=>{try{await k.delete("/stylings/"+l),await _.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),M()}catch(e){_.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}},te=async()=>{try{const{data:l}=await k.get("/products");B.push(...l.result)}catch(l){_.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}},P=async()=>{try{const{data:l}=await k.get("/staffs/cart");p.splice(0,p.length),p.push(...l.result)}catch(l){_.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}},M=async()=>{try{const{data:l}=await k.get("/stylings");U.splice(0,U.length),U.push(...l.result)}catch(l){_.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}};return te(),P(),M(),(l,e)=>{const R=ie("router-link");return a(),v(me,null,{default:d(()=>[s("section",pe,[s("div",xe,[s("div",ve,[_e,o(R,{to:"/staff"},{default:d(()=>[he]),_:1}),o(R,{to:"/staff/styling"},{default:d(()=>[fe]),_:1})]),s("div",ge,[s("div",ye,[g.value?(a(),r("div",be,"\u7A7F\u642D\u7BA1\u7406")):Q("",!0),g.value?Q("",!0):(a(),r("div",qe,"\u7A7F\u642D\u4E0A\u50B3")),o(A),g.value?(a(),v(C,{key:2,class:"q-px-xl",outline:"",color:"black",label:"\u65B0\u589E\u7A7F\u642D",onClick:e[0]||(e[0]=t=>g.value=!1)})):Q("",!0)]),ke,g.value?(a(),v($,{key:1,flat:""},{default:d(()=>[o(w,{class:"q-mb-lg"}),s("div",Ne,[(a(!0),r(f,null,h(U,(t,u)=>(a(),r("div",{class:"col-3 q-pa-xs",key:u},[o(N,{class:"col-12",src:t.image,ratio:4/5},{default:d(()=>[s("div",Be,[o(A),o(S,{name:"fa-solid fa-x",class:"pointer",onClick:q=>ee(t._id)},null,8,["onClick"])])]),_:2},1032,["src"])]))),128))])]),_:1})):(a(),v($,{key:0,flat:"",bordered:"",class:"q-pa-md"},{default:d(()=>[we,o(w,{class:"q-my-md"}),Ve,o(w,{class:"q-my-md"}),o(H,{onSubmit:z(Z,["prevent"])},{default:d(()=>[s("div",Qe,[Ce,o(L,{modelValue:x.name,"onUpdate:modelValue":e[1]||(e[1]=t=>x.name=t),rules:[K.required],color:"black"},null,8,["modelValue","rules"]),Se,o(ne,{modelValue:x.image,"onUpdate:modelValue":e[4]||(e[4]=t=>x.image=t),rules:[K.size],accept:"image/*",filled:"","bottom-slots":"",counter:""},{prepend:d(()=>[o(S,{name:"cloud_upload",onClick:e[2]||(e[2]=z(()=>{},["stop","prevent"]))})]),append:d(()=>[o(S,{name:"close",onClick:e[3]||(e[3]=z(t=>l.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:d(()=>[]),_:1},8,["modelValue","rules"]),Ee,o(L,{modelValue:x.description,"onUpdate:modelValue":e[5]||(e[5]=t=>x.description=t),class:"q-mb-lg",type:"textarea",filled:"",color:"black"},null,8,["modelValue"])]),s("div",Ue,[Ae,o(A),o(S,{name:"fa-solid fa-plus",size:"xs",class:"pointer",onClick:e[6]||(e[6]=t=>D.value=!0)})]),o(w,{class:"q-my-md"}),(a(!0),r(f,null,h(p,(t,u)=>(a(),r("div",{class:"row q-mb-md",key:u},[o(N,{class:"col-2 q-mr-sm",src:t.product.image[0],style:{height:"180px","max-width":"150px"}},null,8,["src"]),s("div",ze,[Ie,s("div",$e,I(t.product.name),1),o(A),s("div",De,"\u5546\u54C1\u984F\u8272:"+I(t.color),1),s("div",Fe,"\u5546\u54C1\u5C3A\u5BF8:"+I(t.size),1)])]))),128)),o(w),s("div",Le,[o(C,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88",onClick:e[7]||(e[7]=t=>Y())}),o(C,{type:"submit",unelevated:"",color:"black",class:"q-py-sm q-px-xxl text-subtitle2",label:"\u78BA\u5B9A"})])]),_:1},8,["onSubmit"])]),_:1})),o(ue,{modelValue:D.value,"onUpdate:modelValue":e[12]||(e[12]=t=>D.value=t),persistent:"",onHide:e[13]||(e[13]=t=>J())},{default:d(()=>[o($,{style:{"min-width":"800px"},class:"q-pa-md"},{default:d(()=>[o(H,{onSubmit:e[11]||(e[11]=z(t=>W(),["prevent"]))},{default:d(()=>[Ke,o(w,{class:"q-my-md"}),s("div",Pe,[Me,o(L,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=t=>m.value=t),color:"black"},{prepend:d(()=>[o(S,{name:"fa-solid fa-magnifying-glass",size:"xs"})]),_:1},8,["modelValue"])]),s("div",Re,[(a(!0),r(f,null,h(E(b),(t,u)=>(a(),v($,{square:"",flat:"",class:"row col-3 q-pa-xs",key:u},{default:d(()=>[s("span",Te,I(t.name),1),o(N,{class:"col-12",src:t.image[0],style:{height:"180px","max-width":"150px"}},null,8,["src"])]),_:2},1024))),128))]),He,E(b).length===1?(a(),r("div",Oe,[(a(!0),r(f,null,h(E(b),t=>(a(),r("div",{key:t.id},[(a(!0),r(f,null,h(t.color,(u,q)=>(a(),v(re,{class:"q-mr-xs",color:u,size:"24px",key:q},null,8,["color"]))),128)),(a(!0),r(f,null,h(t.color,(u,q)=>(a(),v(O,{modelValue:n.value,"onUpdate:modelValue":e[9]||(e[9]=F=>n.value=F),color:"black",class:"text-weight-medium",val:u,label:u,key:q},null,8,["modelValue","val","label"]))),128))]))),128))])):Q("",!0),Xe,E(b).length===1?(a(),r("div",je,[(a(!0),r(f,null,h(E(b),t=>(a(),r("div",{key:t.id},[(a(!0),r(f,null,h(t.size,(u,q)=>(a(),v(O,{modelValue:c.value,"onUpdate:modelValue":e[10]||(e[10]=F=>c.value=F),val:u,color:"black",class:"text-weight-medium",label:u,key:q},null,8,["modelValue","val","label"]))),128))]))),128))])):Q("",!0),s("div",Ge,[T(o(C,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88"},null,512),[[j]]),T(o(C,{type:"submit",unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",color:"black text-white",label:"\u78BA\u5B9A"},null,512),[[j]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])])]),_:1})}}};export{ht as default};
