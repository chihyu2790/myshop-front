import{Q as I}from"./QSpace.212648d1.js";import{N as T,r as q,F as b,P as E,H as m,I as h,J as a,ah as z,ai as F,aj as u,S as o,K as i,T as V,V as v,U as g,Q as p,aB as P,L as Q,ay as k}from"./index.eea27d61.js";import{Q as j,a as H}from"./QTable.7fb2668c.js";import{Q as _}from"./QInput.839b5523.js";import{Q as J}from"./QForm.1a5d5048.js";import{Q as K}from"./QCard.142af412.js";import{Q as L}from"./QPage.6dfcaeca.js";import"./QSeparator.064ca9a1.js";import"./use-dark.a2cfe63f.js";import"./QList.0d47f578.js";import"./rtl.4b414a6d.js";import"./use-prevent-scroll.b1cae2a4.js";import"./focus-manager.d6507951.js";import"./use-key-composition.fd05f9d7.js";import"./format.2a3572e1.js";import"./uid.42677368.js";import"./QChip.27b33b74.js";import"./QMenu.904a3f1b.js";import"./selection.c512185d.js";import"./use-model-toggle.5b3b2788.js";import"./use-timeout.09ac0e3b.js";import"./QDialog.aba9db4f.js";import"./use-form.0e69a4df.js";import"./QCheckbox.7c6115a4.js";import"./option-sizes.3fff056c.js";import"./use-fullscreen.6f5d95cf.js";const M={class:"container"},R={class:"row q-mt-xl"},D={class:"col-2"},G=o("div",{class:"text-h6"},"\u5F8C\u53F0\u7BA1\u7406",-1),O=o("div",{class:"text-subtitle1 q-my-lg"},"\u4F7F\u7528\u8005\u7BA1\u7406",-1),W=o("div",{class:"text-subtitle1 q-my-lg"},"\u5546\u54C1\u7BA1\u7406",-1),X=o("div",{class:"text-subtitle1 q-my-lg"},"\u5E97\u92EA\u7BA1\u7406",-1),Y=o("div",{class:"text-subtitle1 q-my-lg"},"\u8A02\u55AE\u7BA1\u7406",-1),Z={class:"col-10"},ee={class:"flex items-center text-center q-mb-lg"},te={key:0,class:"text-h4 text-weight-medium"},se={key:1,class:"text-h4 text-weight-medium"},le=o("div",{class:"text-body1 q-mb-md"},"\u7BA1\u7406\u5E97\u92EA\u9801\u9762",-1),oe={key:0},ie={class:"column"},ae=Q("\u4FEE\u6539"),re=Q("\u522A\u9664"),de={style:{"max-width":"400px"}},ne=o("div",{class:"text-subtitle1 text-weight-medium"},"\u5E97\u92EA\u540D\u7A31:",-1),me=o("div",{class:"text-subtitle1 text-weight-medium"},"\u5E97\u92EA\u96FB\u8A71:",-1),ue=o("div",{class:"text-subtitle1 text-weight-medium"},"\u5E97\u92EA\u4F4D\u5740:",-1),ce=o("div",{class:"text-subtitle1 text-weight-medium"},"\u71DF\u696D\u6642\u9593:",-1),pe=o("div",{class:"text-subtitle1 text-weight-medium"},"\u8CA9\u552E\u7CFB\u5217:",-1),_e={class:"q-my-xxl"},Je={__name:"StoreAdmin",setup(xe){const C=T(),{logout:w}=C,d=q(!1),S=z(),x=q(""),r=b([]),U=[{name:"name",align:"left",label:"\u5E97\u92EA\u540D\u7A31",field:"name"},{name:"_id",align:"left",label:"\u5E97\u92EA\u7DE8\u865F",field:"_id"},{name:"address",align:"left",label:"\u5E97\u92EA\u4F4D\u5740",field:"address"},{name:"sells",align:"left",label:"\u8CA9\u552E\u7CFB\u5217",field:"sells"},{name:"edit",label:"",align:"left",field:"edit"}],t=b({name:"",phone:"",address:"",time:"",sells:""}),y=()=>{t.name="",t.phone="",t.address="",t.time="",t.sells="",d.value=!1,x.value=""},B=async s=>{try{await k.delete("/stores/"+s),await u.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),f()}catch(e){u.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError&&e.response.data?e.response.data.message:"\u767C\u751F\u932F\u8AA4"})}},N=(s,e)=>{x.value=s,d.value=!0,t.name=r[e].name,t.phone=r[e].phone,t.address=r[e].address,t.time=r[e].time,t.sells=r[e].sells},c=b({required(s){return!!s||"\u5FC5\u586B"},price(s){return s>-1||"\u5FC5\u9808\u5927\u65BC\u7B49\u65BC 0"},size(s){var e,n,l;return!s||!s.length||((n=(e=s[0])==null?void 0:e.type)==null?void 0:n.includes("image"))&&((l=s[0])==null?void 0:l.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),$=async()=>{d.value=!0;try{x.value.length===0?(await k.post("/stores",t),await u.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})):(await k.patch("/stores/"+x.value,t),await u.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})),y(),f(),S.push("/admin/store")}catch(s){u.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError&&s.response.data?s.response.data.message:"\u767C\u751F\u932F\u8AA4"})}},f=async()=>{try{const{data:s}=await F.get("/stores");r.splice(0,r.length),r.push(...s.result)}catch{u.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}};return f(),(s,e)=>{const n=E("router-link");return m(),h(L,null,{default:a(()=>[o("section",M,[o("div",R,[o("div",D,[G,i(n,{to:"/admin/user"},{default:a(()=>[O]),_:1}),i(n,{to:"/admin/product"},{default:a(()=>[W]),_:1}),i(n,{to:"/admin/store"},{default:a(()=>[X]),_:1}),i(n,{to:"/admin/order"},{default:a(()=>[Y]),_:1}),o("div",{class:"text-subtitle1 q-my-lg cursor-pointer",onClick:e[0]||(e[0]=(...l)=>V(w)&&V(w)(...l))},"\u767B\u51FA")]),o("div",Z,[o("div",ee,[d.value?g("",!0):(m(),v("div",te,"\u5E97\u92EA\u7BA1\u7406")),d.value?(m(),v("div",se,"\u65B0\u589E\u5E97\u92EA")):g("",!0),i(I),d.value?g("",!0):(m(),h(p,{key:2,class:"q-px-xl",outline:"",color:"black",label:"\u65B0\u589E\u5E97\u92EA",onClick:e[1]||(e[1]=l=>d.value=!0)}))]),le,d.value?(m(),h(K,{key:1,flat:"",bordered:""},{default:a(()=>[i(J,{onSubmit:e[7]||(e[7]=P(l=>$(),["prevent"])),class:"q-pa-md"},{default:a(()=>[o("div",de,[ne,i(_,{modelValue:t.name,"onUpdate:modelValue":e[2]||(e[2]=l=>t.name=l),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),me,i(_,{modelValue:t.phone,"onUpdate:modelValue":e[3]||(e[3]=l=>t.phone=l),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),ue,i(_,{modelValue:t.address,"onUpdate:modelValue":e[4]||(e[4]=l=>t.address=l),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),ce,i(_,{modelValue:t.time,"onUpdate:modelValue":e[5]||(e[5]=l=>t.time=l),rules:[c.required],color:"black"},null,8,["modelValue","rules"]),pe,i(_,{modelValue:t.sells,"onUpdate:modelValue":e[6]||(e[6]=l=>t.sells=l),rules:[c.required],color:"black"},null,8,["modelValue","rules"])]),o("div",_e,[i(p,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88",onClick:y,disabled:t.submitting},null,8,["disabled"]),i(p,{unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",type:"submit",color:"black text-white",label:"\u78BA\u8A8D"})])]),_:1})]),_:1})):(m(),v("div",oe,[i(H,{grid:s.$q.screen.xs,flat:"",bordered:"",rows:r,columns:U,"row-key":"name"},{"body-cell-edit":a(l=>[i(j,{edit:l},{default:a(()=>[o("div",ie,[i(p,{class:"q-mb-sm q-px-lg",outline:"",onClick:A=>N(l.row._id,l.rowIndex)},{default:a(()=>[ae]),_:2},1032,["onClick"]),i(p,{outline:"",onClick:A=>B(l.row._id)},{default:a(()=>[re]),_:2},1032,["onClick"])])]),_:2},1032,["edit"])]),_:1},8,["grid","rows"])]))])])])]),_:1})}}};export{Je as default};
