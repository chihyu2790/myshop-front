import{aF as H,r as h,s as Le,h as q,aG as He,aH as Be,aI as Ce,w as B,a as r,O as ue,J as De,a2 as m,o as ce,ah as Z,m as v,L as Fe,aJ as Me,c as $e,a8 as ee,b as ze,g as Re,ay as Oe}from"./index.0d4fdb09.js";import{a as Ie,u as Ve}from"./use-timeout.dfa2929f.js";import{u as Ae,a as Qe,b as We}from"./use-model-toggle.6de98c5b.js";import{d as te,e as Ke,b as Ge}from"./use-form.299f2ee0.js";import{b as je,a as Xe,h as Ye}from"./scroll.9caef855.js";const C=[];function gt(e){return C.find(t=>t.__qPortalInnerRef.value!==null&&t.__qPortalInnerRef.value.contains(e))}function Ne(e,t){do{if(e.$options.name==="QMenu"){if(e.hide(t),e.$props.separateClosePopup===!0)return H(e)}else if(e.__qPortalInnerRef!==void 0){const n=H(e);return n!==void 0&&n.$options.name==="QPopupProxy"?(e.hide(t),n):e}e=H(e)}while(e!=null)}function wt(e,t,n){for(;n!==0&&e!==void 0&&e!==null;){if(e.__qPortalInnerRef!==void 0){if(n--,e.$options.name==="QMenu"){e=Ne(e,t);continue}e.hide(t)}e=H(e)}}function Ue(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function Je(e,t,n,l){const s=h(!1),a=h(!1);let i=null;const p={},c=l===!0&&Ue(e);function T(d){if(d===!0){te(p),a.value=!0;return}a.value=!1,s.value===!1&&(c===!1&&i===null&&(i=Be()),s.value=!0,C.push(e.proxy),Ke(p))}function u(d){if(a.value=!1,d!==!0)return;te(p),s.value=!1;const y=C.indexOf(e.proxy);y>-1&&C.splice(y,1),i!==null&&(Ce(i),i=null)}return Le(()=>{u(!0)}),Object.assign(e.proxy,{__qPortalInnerRef:t}),{showPortal:T,hidePortal:u,portalIsActive:s,portalIsAccessible:a,renderPortal:()=>c===!0?n():s.value===!0?[q(He,{to:i},n())]:void 0}}const Ze={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function pt(e,t){const n=h(t.value);return B(t,l=>{ue(()=>{n.value=l})}),{transition:r(()=>"q-transition--"+(n.value===!0?e.transitionHide:e.transitionShow)),transitionStyle:r(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}const g=[];let x;function et(e){x=e.keyCode===27}function tt(){x===!0&&(x=!1)}function ot(e){x===!0&&(x=!1,De(e,27)===!0&&g[g.length-1](e))}function de(e){window[e]("keydown",et),window[e]("blur",tt),window[e]("keyup",ot),x=!1}function nt(e){m.is.desktop===!0&&(g.push(e),g.length===1&&de("addEventListener"))}function oe(e){const t=g.indexOf(e);t>-1&&(g.splice(t,1),g.length===0&&de("removeEventListener"))}const w=[];function fe(e){w[w.length-1](e)}function it(e){m.is.desktop===!0&&(w.push(e),w.length===1&&document.body.addEventListener("focusin",fe))}function ne(e){const t=w.indexOf(e);t>-1&&(w.splice(t,1),w.length===0&&document.body.removeEventListener("focusin",fe))}function lt(e,t,n){let l;function s(){l!==void 0&&(Z.remove(l),l=void 0)}return ce(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){l={condition:()=>n.value===!0,handler:t},Z.add(l)}}}let S=0,I,V,P,A=!1,ie,le,b;function st(e){at(e)&&Fe(e)}function at(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=Me(e),n=e.shiftKey&&!e.deltaX,l=!n&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=n||l?e.deltaY:e.deltaX;for(let a=0;a<t.length;a++){const i=t[a];if(Ye(i,l))return l?s<0&&i.scrollTop===0?!0:s>0&&i.scrollTop+i.clientHeight===i.scrollHeight:s<0&&i.scrollLeft===0?!0:s>0&&i.scrollLeft+i.clientWidth===i.scrollWidth}return!0}function se(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function _(e){A!==!0&&(A=!0,requestAnimationFrame(()=>{A=!1;const{height:t}=e.target,{clientHeight:n,scrollTop:l}=document.scrollingElement;(P===void 0||t!==window.innerHeight)&&(P=n-t,document.scrollingElement.scrollTop=l),l>P&&(document.scrollingElement.scrollTop-=Math.ceil((l-P)/8))}))}function ae(e){const t=document.body,n=window.visualViewport!==void 0;if(e==="add"){const{overflowY:l,overflowX:s}=window.getComputedStyle(t);I=je(window),V=Xe(window),ie=t.style.left,le=t.style.top,t.style.left=`-${I}px`,t.style.top=`-${V}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),l!=="hidden"&&(l==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,m.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",_,v.passiveCapture),window.visualViewport.addEventListener("scroll",_,v.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",se,v.passiveCapture))}m.is.desktop===!0&&m.is.mac===!0&&window[`${e}EventListener`]("wheel",st,v.notPassive),e==="remove"&&(m.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",_,v.passiveCapture),window.visualViewport.removeEventListener("scroll",_,v.passiveCapture)):window.removeEventListener("scroll",se,v.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=ie,t.style.top=le,window.scrollTo(I,V),P=void 0)}function rt(e){let t="add";if(e===!0){if(S++,b!==void 0){clearTimeout(b),b=void 0;return}if(S>1)return}else{if(S===0||(S--,S>0))return;if(t="remove",m.is.ios===!0&&m.is.nativeMobile===!0){clearTimeout(b),b=setTimeout(()=>{ae(t),b=void 0},100);return}}ae(t)}function ut(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,rt(t))}}}let L=0;const ct={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},re={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var yt=$e({name:"QDialog",inheritAttrs:!1,props:{...Ae,...Ze,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...Qe,"shake","click","escape-key"],setup(e,{slots:t,emit:n,attrs:l}){const s=Re(),a=h(null),i=h(!1),p=h(!1),c=h(!1);let T,u=null,d,y;const Q=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:W}=ut(),{registerTimeout:K,removeTimeout:G}=Ie(),{registerTick:me,removeTick:j}=Ve(),{showPortal:X,hidePortal:Y,portalIsAccessible:ve,renderPortal:he}=Je(s,a,_e,!0),{hide:k}=We({showing:i,hideOnRouteChange:Q,handleShow:Ee,handleHide:Se,processOnMount:!0}),{addToHistory:ge,removeFromHistory:we}=lt(i,k,Q),pe=r(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${ct[e.position]}`+(c.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),ye=r(()=>"q-transition--"+(e.transitionShow===void 0?re[e.position][0]:e.transitionShow)),be=r(()=>"q-transition--"+(e.transitionHide===void 0?re[e.position][1]:e.transitionHide)),qe=r(()=>p.value===!0?be.value:ye.value),N=r(()=>`--q-transition-duration: ${e.transitionDuration}ms`),D=r(()=>i.value===!0&&e.seamless!==!0),xe=r(()=>e.autoClose===!0?{onClick:Pe}:{}),Te=r(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${D.value===!0?"modal":"seamless"}`,l.class]);B(i,o=>{ue(()=>{p.value=o})}),B(()=>e.maximized,o=>{i.value===!0&&$(o)}),B(D,o=>{W(o),o===!0?(it(z),nt(M)):(ne(z),oe(M))});function Ee(o){G(),j(),ge(),u=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,$(e.maximized),X(),c.value=!0,e.noFocus!==!0&&(document.activeElement!==null&&document.activeElement.blur(),me(E)),K(()=>{if(s.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:f,bottom:R}=document.activeElement.getBoundingClientRect(),{innerHeight:J}=window,O=window.visualViewport!==void 0?window.visualViewport.height:J;f>0&&R>O/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-O,R>=J?1/0:Math.ceil(document.scrollingElement.scrollTop+R-O/2))),document.activeElement.scrollIntoView()}y=!0,a.value.click(),y=!1}X(!0),c.value=!1,n("show",o)},e.transitionDuration)}function Se(o){G(),j(),we(),U(!0),c.value=!0,Y(),u!==null&&(u.focus(),u=null),K(()=>{Y(!0),c.value=!1,n("hide",o)},e.transitionDuration)}function E(o){Ge(()=>{let f=a.value;f===null||f.contains(document.activeElement)===!0||(f=f.querySelector(o||"[autofocus], [data-autofocus]")||f,f.focus({preventScroll:!0}))})}function F(){E(),n("shake");const o=a.value;o!==null&&(o.classList.remove("q-animate--scale"),o.classList.add("q-animate--scale"),clearTimeout(T),T=setTimeout(()=>{a.value!==null&&(o.classList.remove("q-animate--scale"),E())},170))}function M(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&F():(n("escape-key"),k()))}function U(o){clearTimeout(T),(o===!0||i.value===!0)&&($(!1),e.seamless!==!0&&(W(!1),ne(z),oe(M))),o!==!0&&(u=null)}function $(o){o===!0?d!==!0&&(L<1&&document.body.classList.add("q-body--dialog"),L++,d=!0):d===!0&&(L<2&&document.body.classList.remove("q-body--dialog"),L--,d=!1)}function Pe(o){y!==!0&&(k(o),n("click",o))}function ke(o){e.persistent!==!0&&e.noBackdropDismiss!==!0?k(o):e.noShake!==!0&&F()}function z(o){e.allowFocusOutside!==!0&&ve.value===!0&&Oe(a.value,o.target)!==!0&&E('[tabindex]:not([tabindex="-1"])')}Object.assign(s.proxy,{focus:E,shake:F,__updateRefocusTarget(o){u=o||null}}),ce(U);function _e(){return q("div",{...l,class:Te.value},[q(ee,{name:"q-transition--fade",appear:!0},()=>D.value===!0?q("div",{class:"q-dialog__backdrop fixed-full",style:N.value,"aria-hidden":"true",onMousedown:ke}):null),q(ee,{name:qe.value,appear:!0},()=>i.value===!0?q("div",{ref:a,class:pe.value,style:N.value,tabindex:-1,...xe.value},ze(t.default)):null)])}return he}});export{yt as Q,pt as a,Je as b,it as c,oe as d,Ne as e,nt as f,gt as g,wt as h,C as p,ne as r,Ze as u};
